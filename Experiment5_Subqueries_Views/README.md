# Experiment 5: Subqueries and Views

## AIM
To study and implement subqueries and views.

## THEORY

### Subqueries
A subquery is a query inside another SQL query and is embedded in:
- WHERE clause
- HAVING clause
- FROM clause

**Types:**
- **Single-row subquery**:
  Sub queries can also return more than one value. Such results should be made use along with the operators in and any.
- **Multiple-row subquery**:
  Here more than one subquery is used. These multiple sub queries are combined by means of ‘and’ & ‘or’ keywords.
- **Correlated subquery**:
  A subquery is evaluated once for the entire parent statement whereas a correlated Sub query is evaluated once per row processed by the parent statement.

**Example:**
```sql
SELECT * FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees);
```
### Views
A view is a virtual table based on the result of an SQL SELECT query.
**Create View:**
```sql
CREATE VIEW view_name AS
SELECT column1, column2 FROM table_name WHERE condition;
```
**Drop View:**
```sql
DROP VIEW view_name;
```

**Question 1**

Write a SQL query that retrieve all the columns from the table "Grades", where the grade is equal to the maximum grade achieved in each subject.

Sample table: GRADES (attributes: student_id, student_name, subject, grade)

![Screenshot 2025-04-30 204226](https://github.com/user-attachments/assets/55794135-2217-4a45-9873-ea56842e017a)

```
SELECT *
FROM Grades g
WHERE grade = (
    SELECT MAX(grade)
    FROM Grades
    WHERE subject = g.subject
);

```

**Output:**


![Screenshot 2025-04-30 204231](https://github.com/user-attachments/assets/560df9e3-7fea-43b5-8704-7280febd86e3)



**Question 2**

From the following tables, write a SQL query to find all orders generated by the salespeople who may work for customers whose id is 3007. Return ord_no, purch_amt, ord_date, customer_id, salesman_id.

Table Name: orders


![Screenshot 2025-04-30 204239](https://github.com/user-attachments/assets/17c2aa8d-2884-4ae0-9011-6b958fb90182)

```
SELECT 
   ord_no,
   purch_amt,
   ord_date, 
   customer_id,
   salesman_id
FROM orders
WHERE salesman_id = (
SELECT salesman_id 
FROM orders
WHERE customer_id = 3007
);
```


**Output:**

![Screenshot 2025-04-30 204245](https://github.com/user-attachments/assets/702fabfc-28ce-46ab-a5d6-ea91a3496c76)



**Question 3**

Write a SQL query to Identify customers whose city is different from the city of the customer with the highest ID

SAMPLE TABLE: customer

![Screenshot 2025-04-30 204249](https://github.com/user-attachments/assets/f7d819aa-da4e-4852-bf33-2b28c854d5d9)

```
SELECT *
FROM customer
WHERE city <> (
    SELECT city
    FROM customer
    WHERE id = (SELECT MAX(id) FROM customer)
);

```

**Output:**


![Screenshot 2025-04-30 204254](https://github.com/user-attachments/assets/60be50a8-10a0-4038-badb-2ae5005ad8d6)


**Question 4**

Write a SQL query to retrieve all columns from the CUSTOMERS table for customers whose salary is LESS than $2500.

Sample table: CUSTOMERS

![Screenshot 2025-04-30 204303](https://github.com/user-attachments/assets/eb33e3c1-5c00-4153-8f16-c59744df0ea0)

```
SELECT *
FROM CUSTOMERS
WHERE SALARY < 2500;
```

**Output:**

![Screenshot 2025-04-30 204307](https://github.com/user-attachments/assets/52651b58-6c01-4add-9ced-f002893e17ea)


**Question 5**

Write a SQL query to retrieve all columns from the CUSTOMERS table for customers whose salary is EQUAL TO $1500.

Sample table: CUSTOMERS

![Screenshot 2025-04-30 204311](https://github.com/user-attachments/assets/78546f5b-8ef4-4a7a-bde9-f28194f24ab1)

```
SELECT *
FROM CUSTOMERS
WHERE SALARY = 1500;
```

**Output:**

![Screenshot 2025-04-30 204316](https://github.com/user-attachments/assets/258ef0f4-82b9-4649-ad86-afdb5ac85ada)



**Question 6**

Write a SQL query that retrieves the names of students and their corresponding grades, where the grade is equal to the minimum grade achieved in each subject.

Sample table: GRADES (attributes: student_id, student_name, subject, grade)

![Screenshot 2025-04-30 204322](https://github.com/user-attachments/assets/a1e7437c-c8ad-4ab5-b661-341144dee9a2)

```
SELECT student_name, grade
FROM GRADES g
WHERE grade = (
    SELECT MIN(grade)
    FROM GRADES
    WHERE subject = g.subject
);

```

**Output:**

![Screenshot 2025-04-30 204327](https://github.com/user-attachments/assets/68ec2e63-5697-47e2-a313-100ebbf0b370)


**Question 7**

Write a SQL query to retrieve all columns from the CUSTOMERS table for customers whose AGE is LESS than $30

Sample table: CUSTOMERS

![Screenshot 2025-04-30 204334](https://github.com/user-attachments/assets/ded8c0f2-0d0c-42da-8d40-c0111fdd1216)

```
SELECT *
FROM CUSTOMERS
WHERE AGE < 30;
```

**Output:**

![Screenshot 2025-04-30 204339](https://github.com/user-attachments/assets/5c05df2b-944d-4bdd-b071-91a71b0c02da)


**Question 8**

Write a SQL query to Find employees who have an age less than the average age of employees with incomes over 2.5 Lakh

Employee Table

![Screenshot 2025-04-30 204344](https://github.com/user-attachments/assets/652fa0e0-f933-4066-a1e8-e4ba1f519143)

```
SELECT id, name, age, city, income
FROM Employee
WHERE age < (
    SELECT AVG(age)
    FROM Employee
    WHERE income > 250000
);
```

**Output:**

![Screenshot 2025-04-30 204350](https://github.com/user-attachments/assets/d10613a9-6902-4f00-b981-6836b0d83feb)



**Question 9**

Write a SQL query that retrieves the all the columns from the Table Grades, where the grade is equal to the minimum grade achieved in each subject.

Sample table: GRADES (attributes: student_id, student_name, subject, grade)

![Screenshot 2025-04-30 204358](https://github.com/user-attachments/assets/278af2a3-02ac-4962-8fde-bf87f186e377)

```
SELECT student_id, student_name, subject, grade
FROM GRADES g
WHERE grade = (
    SELECT MIN(grade)
    FROM GRADES
    WHERE subject = g.subject
);

```

**Output:**

![Screenshot 2025-04-30 204403](https://github.com/user-attachments/assets/80b5b3df-3b10-42ed-8471-8ed462705f89)


**Question 10**

From the following tables, write a SQL query to determine the commission of the salespeople in Paris. Return commission.

salesman table

![Screenshot 2025-04-30 204409](https://github.com/user-attachments/assets/d27ac41e-a6cd-4a68-849b-d50fea3eacb1)

```
SELECT commission
FROM salesman 
WHERE salesman_id IN (
SELECT salesman_id 
FROM customer 
WHERE city = 'Paris'
);
```

**Output:**

![Screenshot 2025-04-30 204414](https://github.com/user-attachments/assets/1f646c7f-495c-4706-b30e-c7250c724a42)



## RESULT
Thus, the SQL queries to implement subqueries and views have been executed successfully.

![image](https://github.com/user-attachments/assets/953a548c-dfb6-45b6-aa7c-66586c78d23b)


